{"version":3,"file":"authAdmin.middleware.js","sourceRoot":"","sources":["../../../../src/api/common/middleware/authAdmin.middleware.ts"],"names":[],"mappings":";;;;;;AACA,kFAAyD;AACzD,yDAAqD;AAErD,cAAc;AACP,MAAM,mBAAmB,GAAG,CACjC,GAAY,EACZ,GAAa,EACb,IAAkB,EAClB,EAAE;IACF,IAAI,CAAC;QACH,MAAM,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;QAExC,IAAI,CAAC,KAAK,EAAE,CAAC;YACX,MAAM,IAAI,wBAAa,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC;QAC5C,CAAC;QAED,MAAM,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;QAE7C,MAAM,OAAO,GAAG,wBAAU,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;QACzD,GAAG,CAAC,KAAK,GAAG;YACV,EAAE,EAAE,OAAO,CAAC,EAAE;YACd,IAAI,EAAE,OAAO,CAAC,IAAI;SACnB,CAAC;QACF,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAErB,IAAI,EAAE,CAAC;IACT,CAAC;IAAC,OAAO,KAAU,EAAE,CAAC;QACpB,IAAI,CAAC,IAAI,wBAAa,CAAC,GAAG,EAAE,SAAS,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;IACzD,CAAC;AACH,CAAC,CAAC;AAzBW,QAAA,mBAAmB,uBAyB9B","sourcesContent":["import { Request, Response, NextFunction } from \"express\";\nimport HttpException from \"../exceptions/http.exception\";\nimport { JwtService } from \"../services/jwt.service\";\n\n/** 인증 미들웨어 */\nexport const authAdminMiddleware = (\n  req: Request,\n  res: Response,\n  next: NextFunction\n) => {\n  try {\n    const token = req.headers.authorization;\n\n    if (!token) {\n      throw new HttpException(401, \"토큰이 없습니다.\");\n    }\n\n    const tokenValue = token.split(\"Bearer \")[1];\n\n    const payload = JwtService.verifyAccessToken(tokenValue);\n    req.admin = {\n      id: payload.id,\n      role: payload.role,\n    };\n    console.log(payload);\n\n    next();\n  } catch (error: any) {\n    next(new HttpException(401, `인증 실패 ${error.message}`));\n  }\n};\n"]}